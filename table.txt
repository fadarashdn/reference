@TC-REF-V1.0#demo-table.tsx:import{showAppModal}from"@/utils/hooks/useAppModal";import{EyeOutlined}from"@ant-design/icons";import{GenerativeTable,useSearchInTableColumn,useTablePagination}from"@brdp/ui";import React,{useState}from"react";const deploymentConfigData={isSuccess:true,errorList:[],resultData:{items:[{id:"1",name:"Log_User_Actions_For_Printing_Card_Config",value:"true",comment:"افزودن گزارش تغييرات جانمايي اطلاعات روي کارت به گزارش عمليات کاربران"},{id:"2",name:"Delete_All_Facility_Payment_By_System_User",value:"true",comment:"پشتيباني از حذف تمام پرداخت‌هاي تسهيلاتي توسط کاربر سيستم"},{id:"3",name:"Add_IBan_To_Card_Info_Report_For_Economy_Ministry_Support",value:"false",comment:"پشتيباني از افزودن کد شبا"},{id:"4",name:"Debtor_Profile_On_Facility_Card_Account_Support",value:"true",comment:"پشتيباني از پروفايل بدهکاري بر روي پرونده اعتباري تسهيلاتي"},{id:"5",name:"Log_User_Actions_For_Operation_Authorization_Rule",value:"true",comment:"پشتیبانی از تاریخچه عملیات کاربران برای مجازشماری روال‌ها"},{id:"6",name:"Second_Person_Card_Not_Present_Withdrawal_Trx_Support",value:"true",comment:"پشتيباني از برداشت بدون کارت توسط شخص ديگر"},{id:"7",name:"Voucher_Per_Branch_Topic_Code",value:"2N2065420",configVersion:9,comment:"سرفصل واسط برداشت بدون کارت توسط شخص ديگر"},{id:"8",name:"Batch_Branch_Sanction_Support",value:"false",comment:"پشتيباني از مديريت اختيارات"},{id:"9",name:"Batch_Branch_Sanction_Serial_Number_Sequence",value:"BATCH_BR_SANCTION_SERIAL_NUM",comment:"نام Sequence مربوط به پايگاه داده جهت توليد شماره سريال اختيارات شعب"},{id:"10",name:"Pay_From_Other_Account_Support",value:"true",comment:"پشتيباني از امکان پرداخت از سپرده شخص ديگر"},{id:"11",name:"Max_Job_Thread_Size",value:"30",comment:"ماکزيمم تعداد Thread هاي مديريت Job"},{id:"12",name:"Stamp_Count_For_Issuing_Card_In_VTM",value:"0",comment:"تعداد تمبرها برای صدور کارت"},{id:"13",name:"Operation_Authorization_Rules_Update_Report_Support",value:"true",comment:"پشتيباني از گزارش تغييرات مجازشماري روال ها"},{id:"14",name:"The_PIN_Can_Not_Be_In_The_Any_Parts_Of_CardPAN",value:"true",comment:"پشتيباني از اينکه رمز جديد کارت به هنگام تغيير رمز شامل هيچ 4 رقم پشت هم از شماره کارت نباشد"},{id:"47m_sWQkVbkJjntSPS_UcNQB_9q3N8PdbQy5dFLWuD-z2qEi1rPK5otvfcgeiXBT",name:"The_PIN_Can_Not_Be_In_The_Main_Parts_Of_CardPAN",value:"true",comment:"پشتيباني از تغيير رمزي که شامل هيچ يک از قسمت هاي 4 قسمتي شماره کارت نباشد"},{id:"S01h6Uk2qTT_6qyeT4F84u3jXv6gEWXGSDlIs2Sdd_y_khH7U6zoKgGpA7iOnOgz",name:"Customer_Birth_Date_Check_In_Change_PIN",value:"true",comment:"پشتيباني از بررسي تاريخ تولد مشتري در تغيير رمز"},{id:"QNAonu4knINflkVF03AEAX9MzDrKe9WZmzmvL_G42mV63CffbAUvTElJscbAtOyZ",name:"Card_Expire_Date_Check_In_Change_PIN",value:"true",comment:"جلوگيري از وارد کردن تاريخ انقضا در رمز جديد به هنگام تغيير رمز"},{id:"lqKzBSjJ5fbEMkkronEDGngsidMgIxPnKzkXYeVGpfKkdfxyddWWRKdS_C5bfi9M",name:"Max_SubList_Size_In_Card_Info_Report_For_Economy_Ministry",value:"10000",comment:"حداکثر انداز زيرمجموعه کارت‌ها براي گزارش اطلاعات کارت وزارت اقتصاد و دارايي"},{id:"aePLLgDrvAK_-x0-7YIGPuMI6HagZViy9Y6uvpE1zJ6JLviW013PuYnDQJnjiRtr",name:"Auto_Debit_By_Other_Customer_Deposit_Support",value:"true",comment:"پشتيباني از وارد کردن سپرده غير در پرداخت اتوماتيک"},{id:"DBnlXc_NUM99hQnr7w8JMmxmK1dRzBUZCWA2lwUgt5dAX7LQlUYwZLHXkugckpNJ",name:"Auto_Debit_By_Several_Deposit_Support",value:"true",comment:"پشتيباني از انتخاب چند سپرده براي پرداخت خودکار"}],pageNumber:1,pageSize:6,totalCount:20}};const DemoTable=()=>{const[selectedRowKeys,setSelectedRowKeys]=useState<React.Key[]>([]);const{tableFromIndex,tableConfig}=useTablePagination();const{getColumnSearchProps}=useSearchInTableColumn();return(<GenerativeTable rowKey="id"fromIndex={tableFromIndex}pagination={tableConfig(deploymentConfigData.resultData.totalCount)}rowSelection={{selectedRowKeys,onChange:(s)=>{console.log(s);setSelectedRowKeys(s);}}}rowActions={[{id:"view",appearance:{icon:<EyeOutlined/>,tooltip:"مشاهده"},action:()=>{showAppModal({id:"systemConfigsShowDetailModal",title:"مشاهده مشخصات تنظیمات سامانه",element:<p>تست تس تست</p>,options:{size:"default",closable:true,onCancel:()=>{}}});}}]}rowHighlighter={{"info-color":{label:"توضیحات",shouldHighlight:(record)=>record.id==="1"},"warning-color":{label:"هشدار",shouldHighlight:(record)=>record.id==="2"},"pending-color":{label:"انتظار",shouldHighlight:(record)=>record.id==="3"},"success-color":{label:"موفقیت",shouldHighlight:(record)=>record.id==="4"},"disabled-color":{label:"غیرفعال",shouldHighlight:(record)=>record.id==="5"},"error-color":{label:"خطا",shouldHighlight:(record)=>record.id==="6"},"added-color":{label:"added",shouldHighlight:(record)=>record.id==="7"},"archived-color":{label:"archived",shouldHighlight:(record)=>record.id==="8"},"attention-color":{label:"attention",shouldHighlight:(record)=>record.id==="9"},"highlight-color":{label:"highlight",shouldHighlight:(record)=>record.id==="10"},"neutral-color":{label:"neutral",shouldHighlight:(record)=>record.id==="11"},"note-color":{label:"note",shouldHighlight:(record)=>record.id==="12"},"rejected-color":{label:"rejected",shouldHighlight:(record)=>record.id==="13"},"selected-color":{label:"selected",shouldHighlight:(record)=>record.id==="14"}}}columns={[{key:"name",dataIndex:"name",title:"نام تنظیمات",...getColumnSearchProps("name","نام تنظیمات")},{key:"value",dataIndex:"value",title:"مقدار",...getColumnSearchProps("value","مقدار")},{key:"comment",dataIndex:"comment",title:"توضیحات"}]}data={deploymentConfigData.resultData.items}/>);};export default DemoTable;#generative-table.tsx:import{Card,Table,type TableProps}from"antd";import type{ColumnType,ExpandableConfig,RowSelectMethod,SelectionSelectFn}from"antd/es/table/interface";import{Key,useMemo}from"react";import type{BarAction}from"./table/action";import Actions from"./table/action";import{ActionBarBuilder,type ActionBarBuilderType}from"./table/action-bar-builder";import{type PageSizeType}from"./table/pagination";import{RowHighlighterType}from"./table/row-highlighter/row-highlighter-utils";import{useRowHighlighter}from"./table/row-highlighter/use-row-highlighter";const FixedWidth={ROW_INDEX_WIDTH:60,FIXED_COLS_WIDTH:130,SELECTION_COL_WIDTH:60,ACTION_COL_WIDTH:80};const addEachRowIndex=(rows:any,fromIndex:number)=>{return rows.map((item:any,index:number)=>({...item,__rowIndex:fromIndex+index}))};const addRowIndexColumn=<RecordType,>(columns:TableProps<RecordType>["columns"])=>{const RowIndexColumn:ColumnType={title:"ردیف",dataIndex:"__rowIndex",fixed:"left",align:"center",rowScope:"row",width:FixedWidth.ROW_INDEX_WIDTH};return[RowIndexColumn,...columns!]};const refineColumns=<RecordType,>(columns:TableProps<RecordType>["columns"])=>{return columns!.map((column)=>({...column,align:column.align??"center"}))};const addActionColumn=<RecordType,>(columns:any,rowActions?:BarAction<RecordType>[])=>{if(!rowActions)return columns;const ActionColumn:ColumnType={title:"عملیات",dataIndex:"__actions",width:FixedWidth.ACTION_COL_WIDTH,fixed:"right",align:"center",render:(_value,record,_index)=>{return(<Actions<RecordType>actions={rowActions}record={record}mode={rowActions.length===1?"smart":"ellipsis"}/>)}};return[...columns,ActionColumn]};type GenerativeTableProps<RecordType=any,HeaderActionData=unknown>={title?:string;fromIndex?:number;id?:string;rowKey?:string;loading?:boolean;size?:"small"|"middle";columns:TableProps<RecordType>["columns"];data:Required<TableProps<RecordType>["dataSource"]>;expandable?:{columnTitle?:string;expandedRowRender:ExpandableConfig<RecordType>["expandedRowRender"];rowExpandable:ExpandableConfig<RecordType>["rowExpandable"];expandedRowKeys?:ExpandableConfig<RecordType>["expandedRowKeys"];onExpandedRowsChange?:ExpandableConfig<RecordType>["onExpandedRowsChange"];expandIcon?:ExpandableConfig<RecordType>["expandIcon"];expandRowByClick?:ExpandableConfig<RecordType>["expandRowByClick"]};pagination?:{pageSizeOptions:PageSizeType[];currentPage:number;itemsCount:number|undefined;defaultPageSize?:number;onPageChange?:(page:number,pageSize?:number)=>void};tableHeaderActions?:ActionBarBuilderType<HeaderActionData>[];rowActions?:BarAction<RecordType>[];rowSelection?:{onChange?:(selectedRowKeys:Key[],selectedRows:RecordType[],info:{type:RowSelectMethod})=>void;type?:"single"|"multiple";onSelect?:SelectionSelectFn<RecordType>;selectedRowKeys?:Key[]};rowHighlighter?:RowHighlighterType<RecordType>};const GenerativeTable=<RecordType,HeaderActionData=unknown>({fromIndex,rowKey,id,loading,size="small",columns,data,expandable,pagination,rowActions,rowSelection,rowHighlighter:rowHighlighterProps,tableHeaderActions:tableHeaderActionsProps,title}:GenerativeTableProps<RecordType,HeaderActionData>)=>{const tableData=useMemo(()=>addEachRowIndex(data,fromIndex||1),[data,fromIndex]);const refinedColumns=refineColumns<RecordType>(columns);const tableColumnWithRowIndex=addRowIndexColumn<RecordType>(refinedColumns);const tableColumn=addActionColumn<RecordType>(tableColumnWithRowIndex,rowActions);const rowHighlighter=useRowHighlighter<RecordType,HeaderActionData>(rowHighlighterProps);const tableHeaderActions=[...rowHighlighter.headerAction,...(tableHeaderActionsProps??[])];return(<Card className="brdp-card brdp-generative-table-wrapper"style={{border:"none",borderRadius:0,background:"none"}}title={title??null}extra={tableHeaderActions&&tableHeaderActions.length>=1?(<ActionBarBuilder actionList={tableHeaderActions}/>):null}styles={{title:{fontWeight:"normal",fontSize:"var(--ant-font-size)",paddingInlineEnd:"var(--ant-font-size)"},header:{background:"none",border:"none",padding:0},body:{padding:0}}}><Card className="brdp-card brdp-generative-table-container"styles={{body:{padding:0}}}><Table id={id}rowKey={rowKey}loading={loading}size={size}columns={tableColumn}dataSource={tableData}showHeader={true}scroll={{x:"1000px"}}className="brdp-generative-table"pagination={pagination?{position:["bottomLeft"],hideOnSinglePage:false,pageSize:pagination?.defaultPageSize,total:pagination!.itemsCount,current:pagination?.currentPage,showTitle:true,onChange:pagination?.onPageChange,showTotal:(total,range)=>`مورد ${range[0]} تا ${range[1]} از ${total} مورد`,disabled:loading,pageSizeOptions:[...pagination!.pageSizeOptions],showSizeChanger:{autoClearSearchValue:false,showSearch:false},locale:{items_per_page:""},className:"brdp-generative-table-pagination"}:false}expandable={expandable??undefined}rowSelection={rowSelection?{onChange:rowSelection?.onChange,columnWidth:FixedWidth.SELECTION_COL_WIDTH,type:rowSelection?.type==="single"?"radio":"checkbox",selectedRowKeys:rowSelection?.selectedRowKeys,onSelect:rowSelection?.onSelect}:undefined}rowClassName={rowHighlighter.rowClassName}/></Card></Card>)};export default GenerativeTable;#action.tsx:import{EllipsisOutlined}from"@ant-design/icons";import{generalMessages,getFormatMessage,isFunction}from"@brdp/utils";import{Button as AntButton,App,Divider,Dropdown,Flex,Tooltip}from"antd";import{ItemType}from"antd/es/menu/interface";import React,{Fragment}from"react";import type{IconDefinition}from"../types/type-helpers";export interface BarActionRowParams{id:string;address:string}export interface BarAction<RecordType=unknown>{id:string;appearance:IconDefinition;access?:boolean;action:(data:RecordType,event?:React.BaseSyntheticEvent)=>void;rowParams?:BarActionRowParams[];permissionField?:((record:RecordType)=>boolean)|string;disabled?:((record:RecordType)=>boolean)|boolean;loading?:boolean;confirmMessage?:((record:RecordType)=>string)|string}export type ShowingActionModesList="ellipsis"|"expanded"|"normal"|"smart";type ActionsType<RecordType=unknown>={actions:BarAction<RecordType>[];record:RecordType;mode?:ShowingActionModesList};const Actions=<RecordType,>({actions,record,mode}:ActionsType<RecordType>)=>{const{modal}=App.useApp();const messages=getFormatMessage();const _mode:ShowingActionModesList=mode??"smart";const overflowItemsCount=_mode==="ellipsis"?0:4;const itemsCountOutPoint=_mode==="ellipsis"?0:2;const mightHaveDropdown=_mode==="ellipsis"||_mode==="smart";const filteredActions=actions.filter((action)=>typeof action.permissionField==="function"?action.permissionField(record):action.permissionField?(record as Record<string,unknown>)[action.permissionField]:true);if(mightHaveDropdown&&filteredActions.length>overflowItemsCount){const firstTwoActions=filteredActions.slice(0,itemsCountOutPoint);const restActions=filteredActions.slice(itemsCountOutPoint);const menuItems=restActions.flatMap<ItemType>((action)=>{const isDisabled=typeof action.disabled==="function"?action.disabled(record):action.disabled;const dividerObj:ItemType=action.appearance.hasDivider?{type:"divider"}:null;return[dividerObj,{label:action.appearance.label||action.appearance.tooltip,key:action.id,icon:action.appearance.icon,onClick:isDisabled?undefined:(event:any)=>{if(!!action.confirmMessage){modal.confirm({title:messages(generalMessages.modalConfirmTitle),content:(<div style={{padding:"0.25rem 0"}}>{isFunction(action.confirmMessage)?action.confirmMessage(record):action.confirmMessage}</div>),onOk:action.action.bind(null,record,event),centered:true,width:450,closable:false});return}if(action.access===false){console.log(`%c[${new Date().toLocaleTimeString()}] %caccess denied%c on: ${action.id}`,"color: red","font-weight: bold; color: red","color: red");modal.error({title:"عدم دسترسی",content:"مجوز دسترسی به این بخش را ندارید."})}else{console.log("access granted.");action.action(record,event)}},disabled:isDisabled}]});return(<Flex align="flex-start"justify="center"gap="small"><ActionButton<RecordType>actions={firstTwoActions}record={record}/><Dropdown menu={{items:menuItems,subMenuCloseDelay:0.35}}placement="bottomLeft"arrow mouseEnterDelay={0.1}mouseLeaveDelay={0.3}><AntButton icon={<EllipsisOutlined/>}type="text"/></Dropdown></Flex>)}return(<Flex align="center"justify="center"gap="small"><ActionButton<RecordType>actions={filteredActions}record={record}expanded={_mode==="expanded"}/></Flex>)};function ActionButton<RecordType=unknown>({actions,record,expanded}:{actions:BarAction<RecordType>[];record:RecordType;expanded?:boolean}){const{modal}=App.useApp();const messages=getFormatMessage();return actions.map((action,index)=>{const isDisabled=typeof action.disabled==="function"?action.disabled(record):action.disabled;const hasDivider=action.appearance.hasDivider;const isFirstItem=index===0;return(<Fragment key={action.id}>{hasDivider&&(<Divider type="vertical"orientationMargin={0}variant="solid"orientation="center"style={{height:"1.5em",marginInlineEnd:isFirstItem?8:0,marginInlineStart:0}}/>)}<Tooltip title={action.appearance.tooltip}><AntButton onClick={isDisabled?undefined:(event)=>{if(!!action.confirmMessage){modal.confirm({title:messages(generalMessages.modalConfirmTitle),content:(<div style={{padding:"0.25rem 0"}}>{isFunction(action.confirmMessage)?action.confirmMessage(record):action.confirmMessage}</div>),onOk:action.action.bind(null,record,event),centered:true,width:450,closable:false});return}if(action.access===false){console.log(`%c[${new Date().toLocaleTimeString()}] %caccess denied%c on: ${action.id}`,"color: red","font-weight: bold; color: red","color: red");modal.error({title:"عدم دسترسی",content:"دسترسی انجام عملیات وجود ندارد."})}else{console.log("access granted.");action.action(record,event)}}}icon={action.appearance.icon}disabled={isDisabled}loading={action.loading}type={action.appearance.primary?"primary":undefined}>{expanded?action.appearance.tooltip:null}</AntButton></Tooltip></Fragment>)})}export default Actions;#action-bar-builder.tsx:import{Flex}from"antd";import Typography from"../typography/typography";import Actions,{BarAction,ShowingActionModesList}from"./action";export type ActionBarBuilderType<ActionsData=unknown>={id:string;actions:BarAction<ActionsData>[];label?:string;mode?:ShowingActionModesList;data?:ActionsData};type ActionBarBuilderProp<ActionsData=unknown>={actionList:ActionBarBuilderType<ActionsData>[]};export const ActionBarBuilder=<ActionsData,>({actionList}:ActionBarBuilderProp<ActionsData>)=>{if(!actionList||actionList.length===0)return null;return(<Flex align="center"justify="flex-end"gap={16}>{actionList.map((record)=>{return(<Flex key={`action-${record.id}`}align="center"justify="flex-end"gap={8}>{record.label&&<Typography type="text"text={record.label}/>}<Actions<ActionsData>actions={record.actions}record={record.data as ActionsData}mode={record.mode?record.mode:"normal"}/></Flex>)})}</Flex>)};#pagination.tsx:import{useState}from"react";const DefaultPageSizeOptions=[6,10,20,50,100]as const;export type PageSizeType=(typeof DefaultPageSizeOptions)[number];export const useTablePagination=(options?:{currentPage?:number;defaultPageSize?:PageSizeType})=>{const DEFAULT_PAGE_SIZE=options?.defaultPageSize||DefaultPageSizeOptions[0];const[page,setPage]=useState(options?.currentPage||1);const[pageSize,setPageSize]=useState(DEFAULT_PAGE_SIZE);const nextPage=()=>setPage((prev)=>prev+1);const prevPage=()=>setPage((prev)=>Math.max(prev-1,1));const updatePage=(newPage:number)=>setPage(Math.max(newPage,1));const resetPage=()=>setPage(1);const updatePageSize=(newSize:PageSizeType)=>{setPageSize(newSize);updatePage(1)};const pageIndex=page-1;const offset=page===1?0:pageIndex*pageSize;const skip=pageIndex*pageSize;return{PAGE_SIZE:pageSize,offset,pageIndex,tableFromIndex:offset+1,currentPage:page,skip,nextPage,prevPage,updatePage,resetPage,updatePageSize,tableConfig:(itemsCount:number)=>({pageSizeOptions:[...DefaultPageSizeOptions],currentPage:page,itemsCount,defaultPageSize:pageSize,onPageChange:(newPage:number,newPageSize?:number)=>{if(newPageSize&&newPageSize!==pageSize){updatePageSize(newPageSize as PageSizeType)}else{updatePage(newPage)}}})}};#use-search-in-table-column.tsx:import{SearchOutlined}from"@ant-design/icons";import{generalMessages,getFormatMessage}from"@brdp/utils";import{Button,Flex,Input,InputRef,TableColumnType}from"antd";import{AnyObject}from"antd/es/_util/type";import{FilterDropdownProps}from"antd/es/table/interface";import{useRef,useState}from"react";export const useSearchInTableColumn=<DataType=AnyObject>()=>{const[_searchText,setSearchText]=useState<string>("");const[_searchedColumn,setSearchedColumn]=useState<string>("");const searchInput=useRef<InputRef>(null);const messages=getFormatMessage();const handleSearch=(selectedKeys:string[],dataIndex:keyof DataType,confirm:FilterDropdownProps["confirm"])=>{const selectedKey=selectedKeys[0];if(selectedKey){setSearchText(selectedKey);setSearchedColumn(String(dataIndex));confirm()}};const handleReset=(clearFilters:()=>void,confirm:FilterDropdownProps["confirm"])=>{clearFilters();setSearchText("");confirm()};const getColumnSearchProps=(dataIndex:keyof DataType,placeholder:string):TableColumnType<DataType>=>{return{filterDropdown:({setSelectedKeys,selectedKeys,clearFilters,close,confirm})=>(<div style={{padding:12,minWidth:"230px"}}onKeyDown={(e)=>e.stopPropagation()}><Input ref={searchInput}placeholder={`${messages(generalMessages.searchIn)} ${placeholder}`}value={selectedKeys[0]}onChange={(e)=>setSelectedKeys(e.target.value?[e.target.value]:[])}disabled={false}readOnly={false}onPressEnter={()=>handleSearch(selectedKeys as string[],dataIndex,confirm)}style={{marginBottom:12,display:"block"}}/><Flex gap="small"align="center"justify="space-between"><Flex gap="small"><Button type="primary"onClick={()=>handleSearch(selectedKeys as string[],dataIndex,confirm)}size="small"disabled={false}>{messages(generalMessages.search)}</Button><Button onClick={()=>clearFilters&&handleReset(clearFilters,confirm)}size="small"disabled={false}>{messages(generalMessages.clearForm)}</Button></Flex><Button type="link"size="small"disabled={false}onClick={()=>{close()}}>{messages(generalMessages.close)}</Button></Flex></div>),filterIcon:(filtered:boolean)=>(<SearchOutlined style={{color:filtered?"var(--ant-blue)":undefined}}/>),onFilter:(value,record)=>{const recordValue=record[dataIndex]?record[dataIndex].toString().toLowerCase().trim():undefined;const valueTrim=value?value.toString().toLowerCase().trim():undefined;if(!recordValue||!valueTrim)return false;return recordValue.includes(valueTrim)},filterDropdownProps:{onOpenChange(open){if(open){setTimeout(()=>searchInput.current?.select(),100)}}}}};return{getColumnSearchProps}as const};#color-guide-icon.tsx:import IconFactory from'../../Icon/icon-factory';const ColorGuideSvg=()=>(<svg xmlns="http://www.w3.org/2000/svg"viewBox="0 0 32 32"width={20}height={20}fill="var(--ant-color-text-secondary)"style={{transform:"translateY(2px)"}}><path d="M27.32,18.11H23.7l2.55-2.54a4.66,4.66,0,0,0,1.47-3.31A4.63,4.63,0,0,0,26.25,9l-3.2-3.2a4.52,4.52,0,0,0-6.62,0L13.89,8.29V4.68A4.48,4.48,0,0,0,9.21,0H4.68A4.47,4.47,0,0,0,0,4.68V23.93a11.25,11.25,0,0,0,.25,2.95,7,7,0,0,0,1.27,2.51,6.91,6.91,0,0,0,4,2.46,22.06,22.06,0,0,0,3.9.13c.73,0,1.46,0,2.19,0H27.32A4.47,4.47,0,0,0,32,27.31V22.79A4.47,4.47,0,0,0,27.32,18.11ZM13.89,10.85,17.71,7a2.69,2.69,0,0,1,4.06,0l3.2,3.2a2.89,2.89,0,0,1,.94,2,2.9,2.9,0,0,1-.94,2L13.88,25.37c0-.11,0-.21,0-.32ZM5.94,30.08,5.42,30h0a5.19,5.19,0,0,1-1-.45l-.32-.2a5.23,5.23,0,0,1-1.44-1.45l-.16-.24a5.58,5.58,0,0,1-.46-1h0c-.06-.18-.09-.35-.13-.49a6,6,0,0,1-.1-1V4.68A2.65,2.65,0,0,1,4.68,1.82H9.21a2.66,2.66,0,0,1,2.87,2.86V25.05a5.13,5.13,0,0,1-1.52,3.63,4.1,4.1,0,0,1-.37.33,4.64,4.64,0,0,1-1.28.77l-.41.16a4.79,4.79,0,0,1-1.22.21H7.19A5.09,5.09,0,0,1,5.94,30.08Zm24.24-2.77a2.66,2.66,0,0,1-2.86,2.87H11.61a3.69,3.69,0,0,0,.29-.28l10-10h5.42a2.66,2.66,0,0,1,2.86,2.87Z"/><path d="M9.36,25.05A2.42,2.42,0,1,0,7,27.46,2.41,2.41,0,0,0,9.36,25.05Zm-3,0a.61.61,0,1,1,.61.6A.6.6,0,0,1,6.34,25.05Z"/></svg>);export const ColorGuideIcon=()=><IconFactory SVG={ColorGuideSvg}/>;#color-guide-modal.tsx:import{Flex}from"antd";import{ActiveColorType,ROW_COLORS}from"./row-highlighter-utils";import{ColorGuideIcon}from"./color-guide-icon";import{generalMessages,getFormatMessage}from"@brdp/utils";import{memo}from"react";export const ModalTitle=memo(function ModalTitle(){const messages=getFormatMessage();return(<Flex align="center"justify="flex-start"gap="small"><ColorGuideIcon/>{messages(generalMessages.colorGuide)}</Flex>)});export const ModalContent=memo(function ModalContent({colorsList}:{colorsList:ActiveColorType[]}){return(<Flex component="ul"align="start"justify="flex-start"vertical gap="small">{colorsList.map(({colorName,label},index)=>{return(<Flex component="li"key={index}align="center"justify="flex-start"gap="small"><span style={{width:"24px",height:"24px",borderRadius:"6px",backgroundColor:ROW_COLORS[colorName],border:`2px solid rgba(0,0,0,0.30)`}}/><span>{label}</span></Flex>)})}</Flex>)});#row-highlighter.module.css:.modal{:global{.ant-modal-body{padding:0!important}.ant-modal-confirm-paragraph{max-width:100%;row-gap:0}.ant-modal-confirm-title{padding:var(--ant-modal-header-padding);background-color:var(--ant-modal-header-bg);border-bottom:var(--ant-modal-header-border-bottom);border-top-left-radius:var(--ant-border-radius-lg);border-top-right-radius:var(--ant-border-radius-lg)}.ant-modal-confirm-content{padding:var(--ant-modal-body-padding)}.ant-modal-confirm-btns{padding:var(--ant-modal-footer-padding);margin-top:var(--ant-modal-footer-margin-top);border-top:var(--ant-modal-footer-border-top);button{--ant-button-padding-inline:var(--modal-button-padding-inline)}}}}#row-highlighter-utils.ts:export const ROW_COLORS={"info-color":"#B3C2FF","warning-color":"#F0DD8A","pending-color":"#F99D7B","success-color":"#DCFFEE","disabled-color":"#D1D0D0","error-color":"#FF8977","selected-color":"#A68AD0","highlight-color":"#C8B9D7","rejected-color":"#F98C96","attention-color":"#FEE0DE","added-color":"#FFD7FE","note-color":"#FFF4C5","archived-color":"#DCBEC8","neutral-color":"#EFEFEF"};export type RowColorKeys=keyof typeof ROW_COLORS;export type RowHighlighterType<RecordType>=Partial<Record<RowColorKeys,{label:string;shouldHighlight:(record:RecordType,index:number,indent:number)=>boolean}>>;export interface ActiveColorType{colorName:RowColorKeys;label:string}#use-row-highlighter.tsx:import classes from'./row-highlighter.module.css';import{useCallback,useMemo}from"react";import{ActiveColorType,RowColorKeys,RowHighlighterType}from"./row-highlighter-utils";import{generalMessages,getFormatMessage}from"@brdp/utils";import{ColorGuideIcon}from"./color-guide-icon";import{ActionBarBuilderType}from"../action-bar-builder";import{App}from"antd";import{ModalContent,ModalTitle}from"./color-guide-modal";import clsx from"clsx";type RowClassName<RecordType>=undefined|((record:RecordType,index:number,indent:number)=>string);export const useRowHighlighter=<RecordType,HeaderActionData>(rowHighlighter?:RowHighlighterType<RecordType>)=>{const messages=getFormatMessage();const{modal}=App.useApp();const activeColorsList=useMemo<ActiveColorType[]>(()=>{return Object.entries(rowHighlighter??{}).map(([colorName,{label}])=>{return{colorName:colorName as RowColorKeys,label}})},[rowHighlighter]);const modalInfo=useCallback(()=>{modal.info({maskClosable:false,width:"25.25rem",keyboard:true,okText:messages(generalMessages.understand),title:<ModalTitle/>,wrapClassName:classes.modal,icon:null,destroyOnClose:true,footer:(_,{OkBtn})=>{return<OkBtn/>},closable:true,content:<ModalContent colorsList={activeColorsList}/>})},[activeColorsList,messages,modal]);const headerAction=useMemo<ActionBarBuilderType<HeaderActionData>[]>(()=>{if(!rowHighlighter)return[];return[{id:"rowHighlighterLabel",label:messages(generalMessages.colorGuide).concat(":"),actions:[{id:"rowHighlighterAction",appearance:{icon:<ColorGuideIcon/>,label:messages(generalMessages.colorGuide)},action:modalInfo}]}]},[messages,modalInfo,rowHighlighter]);const rowClassName=useMemo<RowClassName<RecordType>>(()=>{if(!rowHighlighter)return undefined;const highlighterEntries=Object.entries(rowHighlighter);return(record,index,indent)=>{const clsxInputs=highlighterEntries.reduce<Partial<Record<RowColorKeys,boolean>>>((acc,[key,{shouldHighlight}])=>{return{...acc,[key]:shouldHighlight(record,index,indent)}},{});return clsx(clsxInputs)}},[rowHighlighter]);return{headerAction,rowClassName}as const};#table.css:.brdp-generative-table{--brdp-row-info-color:#b3c2ff;--brdp-row-warning-color:#f0dd8a;--brdp-row-pending-color:#f99d7b;--brdp-row-success-color:#dcffee;--brdp-row-disabled-color:#d1d0d0;--brdp-row-error-color:#ff8977;--brdp-row-selected-color:#a68ad0;--brdp-row-highlight-color:#c8b9d7;--brdp-row-rejected-color:#f98c96;--brdp-row-attention-color:#fee0de;--brdp-row-added-color:#ffd7fe;--brdp-row-note-color:#fff4c5;--brdp-row-archived-color:#dcbec8;--brdp-row-neutral-color:#efefef;.ant-table-row.info-color{th,td{background-color:var(--brdp-row-info-color);&.ant-table-cell-row-hover{background:linear-gradient(0deg,rgba(0,0,0,0.1)0%,rgba(0,0,0,0.1)100%),var(--brdp-row-info-color)}}}.ant-table-row.warning-color{th,td{background-color:var(--brdp-row-warning-color);&.ant-table-cell-row-hover{background:linear-gradient(0deg,rgba(0,0,0,0.1)0%,rgba(0,0,0,0.1)100%),var(--brdp-row-warning-color)}}}.ant-table-row.pending-color{th,td{background-color:var(--brdp-row-pending-color);&.ant-table-cell-row-hover{background:linear-gradient(0deg,rgba(0,0,0,0.1)0%,rgba(0,0,0,0.1)100%),var(--brdp-row-pending-color)}}}.ant-table-row.success-color{th,td{background-color:var(--brdp-row-success-color);&.ant-table-cell-row-hover{background:linear-gradient(0deg,rgba(0,0,0,0.1)0%,rgba(0,0,0,0.1)100%),var(--brdp-row-success-color)}}}.ant-table-row.disabled-color{th,td{background-color:var(--brdp-row-disabled-color);&.ant-table-cell-row-hover{background:linear-gradient(0deg,rgba(0,0,0,0.1)0%,rgba(0,0,0,0.1)100%),var(--brdp-row-disabled-color)}}}.ant-table-row.error-color{th,td{background-color:var(--brdp-row-error-color);&.ant-table-cell-row-hover{background:linear-gradient(0deg,rgba(0,0,0,0.1)0%,rgba(0,0,0,0.1)100%),var(--brdp-row-error-color)}}}.ant-table-row.selected-color{th,td{background-color:var(--brdp-row-selected-color);&.ant-table-cell-row-hover{background:linear-gradient(0deg,rgba(0,0,0,0.1)0%,rgba(0,0,0,0.1)100%),var(--brdp-row-selected-color)}}}.ant-table-row.highlight-color{th,td{background-color:var(--brdp-row-highlight-color);&.ant-table-cell-row-hover{background:linear-gradient(0deg,rgba(0,0,0,0.1)0%,rgba(0,0,0,0.1)100%),var(--brdp-row-highlight-color)}}}.ant-table-row.rejected-color{th,td{background-color:var(--brdp-row-rejected-color);&.ant-table-cell-row-hover{background:linear-gradient(0deg,rgba(0,0,0,0.1)0%,rgba(0,0,0,0.1)100%),var(--brdp-row-rejected-color)}}}.ant-table-row.attention-color{th,td{background-color:var(--brdp-row-attention-color);&.ant-table-cell-row-hover{background:linear-gradient(0deg,rgba(0,0,0,0.1)0%,rgba(0,0,0,0.1)100%),var(--brdp-row-attention-color)}}}.ant-table-row.added-color{th,td{background-color:var(--brdp-row-added-color);&.ant-table-cell-row-hover{background:linear-gradient(0deg,rgba(0,0,0,0.1)0%,rgba(0,0,0,0.1)100%),var(--brdp-row-added-color)}}}.ant-table-row.note-color{th,td{background-color:var(--brdp-row-note-color);&.ant-table-cell-row-hover{background:linear-gradient(0deg,rgba(0,0,0,0.1)0%,rgba(0,0,0,0.1)100%),var(--brdp-row-note-color)}}}.ant-table-row.archived-color{th,td{background-color:var(--brdp-row-archived-color);&.ant-table-cell-row-hover{background:linear-gradient(0deg,rgba(0,0,0,0.1)0%,rgba(0,0,0,0.1)100%),var(--brdp-row-archived-color)}}}.ant-table-row.neutral-color{th,td{background-color:var(--brdp-row-neutral-color);&.ant-table-cell-row-hover{background:linear-gradient(0deg,rgba(0,0,0,0.1)0%,rgba(0,0,0,0.1)100%),var(--brdp-row-neutral-color)}}}}
